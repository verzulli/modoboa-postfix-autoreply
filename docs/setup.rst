#####
Setup
#####

The modoboa autoreply plugin requires that an ``autoreply`` script is executed by 
``postfix`` via a proper ``master.cf`` module:

``/etc/postfix/master.cf``::

  autoreply unix        -       n       n       -       -       pipe
            flags= user=<modoboa_user>:<modoboa_group> argv=<full_path_to_modoboa_site>/manage.py autoreply $sender $mailbox

Please note that:

- the two parameters ``<modoboa_user>`` and ``<modoboa_group>`` are **critically important**: they should match the ``UID`` and ``GID`` of the ``modoboa`` engine running on your web server.
  This is required as the ``autoreply`` module need read-access to ``settings.py`` (to retrieve database connection parameters as well as other data related to the outgoing mail to send). Also, under ``virtualenv`` scenarios it is required that both the ``modoboa`` application and the ``autoreply`` module share the same... environment (relying on the same ``UID`` and ``GID`` will easily solve this issue as well).
- ``<full_path_to_modoboa_site>`` is the full-path of your ``manage.py`` script, under the Modoboa instance folder.

If you have trouble understanding above issues, feel free to check our mailing-list and/or ask there for details.

------------------------------

The ``autoreply`` module defined in postfix ``master.cf`` configuration file, will be triggered by a proper ``transport map``. This means that:

- Postfix ``main.cf`` need to be updated including

``/etc/postfix/main.cf``::

  transport_maps = <driver>:/etc/postfix/sql-autoreplies-transport.cf

Replace ``<driver>`` by the name of the database you
use. 

- above ``sql-autoreplies-transport.cf`` need to be auto generated by modoboa with:

  $ python manage.py generate_postfix_maps --destdir <path>

``path`` is the directory where the files will be stored. Please note that above command will re-create **ALL** the postfix map files, even if you actually need only ``sql-autoreply-transport.cf``. Feel free to generate them under ``/tmp`` and, after proper review, move ``sql-autoreply-transport.cf`` under ``/etc/postfix`` as referred inside ``main.cf``



.. note::

   The order used to define alias maps is important, please respect it



.. note::

   Auto-reply messages are just sent once per sender for a
   pre-defined time period. By default, this period is equal to 1 day
   (86400s), you can adjust this value by modifying the **Automatic
   reply timeout** parameter available in the online panel.
